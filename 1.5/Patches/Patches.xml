<Patch>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="Plant_TreeGauranlen"]/comps/li[@Class="CompProperties_TreeConnection"]</xpath>
    <value>
      <li Class="Dryad.CompProperties_NewTreeConnection">
        <pawnKind>Dryad_Basic</pawnKind>
        <spawnDays>3</spawnDays>
        <initialConnectionStrengthRange>0.2~0.2</initialConnectionStrengthRange>
        <connectionStrengthLossPerDryadDeath>0.1</connectionStrengthLossPerDryadDeath>
        <connectionStrengthGainPerHourPruningBase>0.1</connectionStrengthGainPerHourPruningBase>
        <spawningPodOffset>(-0.15, 0, -0.55)</spawningPodOffset>
        <spawningPodSizeRange>0.4~0.65</spawningPodSizeRange>
        <maxDryadsWild>1</maxDryadsWild>
        <gauTiers>
          <li>Dryad_TierUltimate</li>
          <li>Dryad_TierPenultimate</li>
          <li>Dryad_TierGreat</li>
          <li>Dryad_TierGood</li>
          <li>Dryad_TierNormal</li>
          <li>Dryad_TierPoor</li>
          <li>Dryad_TierBad</li>
          <li>Dryad_TierWorst</li>
        </gauTiers>
        <harmonyBuildings>
          <li MayRequire="Ludeon.Rimworld.Royalty">AnimusStone</li>
          <li MayRequire="Ludeon.Rimworld.Royalty">NatureShrine_Small</li>
          <li MayRequire="Ludeon.Rimworld.Royalty">NatureShrine_Large</li>
          <li>Dryad_GauranlenShrine_Small</li>
          <li>Dryad_GauranlenShrine_Large</li>
          <li>Dryad_VikingShrine</li>
        </harmonyBuildings>
        <maxDryadsPerConnectionStrengthCurve>
          <points>
            <li>(0.05, 0)</li>
            <li>(0.23, 1)</li>
            <li>(0.48, 2)</li>
            <li>(0.73, 3)</li>
            <li>(0.90, 4)</li>
            <li>(0.91, 5)</li>
            <li>(0.92, 6)</li>
            <li>(0.93, 7)</li>
            <li>(0.94, 8)</li>
            <li>(0.95, 9)</li>
            <li>(0.96, 10)</li>
            <li>(0.97, 11)</li>
            <li>(0.98, 12)</li>
            <li>(0.99, 13)</li>
            <li>(1, 14)</li>
          </points>
        </maxDryadsPerConnectionStrengthCurve>
        <connectionLossPerLevelCurve>
          <points>
            <li>(0, -0.1)</li>
          </points>
        </connectionLossPerLevelCurve>
        <connectionLossDailyPerBuildingDistanceCurve>
          <points>
            <li>(0,0)</li>
          </points>
        </connectionLossDailyPerBuildingDistanceCurve>
        <connectionStrengthGainPerPlantSkill>
          <points>
            <li>(0, 50)</li>
            <li>(8, 1)</li>
            <li>(20, 1.2)</li>
          </points>
        </connectionStrengthGainPerPlantSkill>
      </li>
    </value>
  </Operation>

  <Operation Class="PatchOperationConditional">
    <xpath>Defs/ThingDef[defName="Plant_TreeGauranlen"]/comps/li[@Class="CompProperties_MeditationFocus"]</xpath>
    <nomatch Class="PatchOperationAdd">
      <xpath>Defs/ThingDef[defName="Plant_TreeGauranlen"]/comps</xpath>
      <value>
        <li Class="CompProperties_MeditationFocus" MayRequire="Ludeon.Rimworld.Royalty">
          <statDef>MeditationFocusStrength</statDef>
          <focusTypes>
            <li>Natural</li>
          </focusTypes>
          <offsets>
            <li Class="FocusStrengthOffset_ArtificialBuildings">
              <radius>7.9</radius>
              <curve>
                <points>
                  <li>(0,   0.0)</li>
                  <li>(5,  -0.05)</li>
                  <li>(10, -0.1)</li>
                  <li>(50, -0.15)</li>
                </points>
              </curve>
            </li>
            <li Class="FocusStrengthOffset_BuildingDefs">
              <defs>
                <AnimusStone MayRequire="Ludeon.RimWorld.Royalty">0.03</AnimusStone>
                <NatureShrine_Small MayRequire="Ludeon.RimWorld.Royalty">0.01</NatureShrine_Small>
                <NatureShrine_Large MayRequire="Ludeon.RimWorld.Royalty">0.01</NatureShrine_Large>
                <Dryad_GauranlenShrine_Small MayRequire="Ludeon.RimWorld.Royalty">0.01</Dryad_GauranlenShrine_Small>
                <Dryad_GauranlenShrine_Large MayRequire="Ludeon.RimWorld.Royalty">0.01</Dryad_GauranlenShrine_Large>
                <Dryad_VikingShrine MayRequire="Ludeon.RimWorld.Royalty">0.01</Dryad_VikingShrine>
              </defs>
              <radius>7.9</radius>
              <maxBuildings>4</maxBuildings>
              <explanationKey>MeditationFocusPerAnimusStoneAndShrine</explanationKey>
              <explanationKeyAbstract>MeditationFocusPerAnimusStoneAndShrineAbstract</explanationKeyAbstract>
            </li>
          </offsets>
        </li>
      </value>
    </nomatch>
  </Operation>

  <Operation Class="PatchOperationConditional">
    <xpath>Defs/ThingDef[defName="Plant_TreeGauranlen"]/statBases/MeditationFocusStrength</xpath>
    <nomatch Class="PatchOperationAdd">
      <xpath>Defs/ThingDef[defName="Plant_TreeGauranlen"]/statBases</xpath>
      <value>
        <MeditationFocusStrength>0.24</MeditationFocusStrength>
      </value>
    </nomatch>
  </Operation>
  
  <!-- <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="Plant_TreeGauranlen"]/drawPlaceWorkersWhileSelected</xpath>
    <value>
      <drawPlaceWorkersWhileSelected>false</drawPlaceWorkersWhileSelected>
    </value>
  </Operation> -->

  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="Plant_TreeGauranlen"]/placeWorkers</xpath>
    <value>
      <placeWorkers>
        <li Inherit="False">Dryad.PlaceWorker_Woody</li>
      </placeWorkers>
      
      <!-- PlaceWorker_ShowFacilitiesConnections -->
    </value>
  </Operation>


  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="DryadCocoon"]/comps/li[@Class="CompProperties_DryadCocoon" or @Class="DryadHealingPod"]/daysToComplete</xpath>
    <value>
      <daysToComplete>1</daysToComplete>
    </value>
  </Operation>

  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThinkTreeDef[defName="Dryad"]/thinkRoot/subNodes/li[@Class="ThinkNode_ConditionalOfPlayerFaction"]/subNodes/li[@Class="ThinkNode_ChancePerHour_Constant"]</xpath>
    <value>
      <li Class="ThinkNode_ConditionalRequireCapacities">
        <requiredCapacities>
          <li>Manipulation</li>
        </requiredCapacities>
        <subNodes>
          <li Class="ThinkNode_ChancePerHour_Constant">
            <mtbHours>0.1</mtbHours>
            <subNodes>
              <!-- Trained behavior: Haul-->
              <li Class="ThinkNode_ConditionalTrainableCompleted">
                <trainable>Haul</trainable>
                <subNodes>
                  <li Class="ThinkNode_Tagger">
                    <tagToGive>TrainedAnimalBehavior</tagToGive>
                    <subNodes>
                      <li Class="JobGiver_Haul" />
                    </subNodes>
                  </li>
                </subNodes>
              </li>
            </subNodes>
          </li>
          <li Class="ThinkNode_ChancePerHour_Constant">
            <mtbHours>2</mtbHours>
            <subNodes>
              <li Class="ThinkNode_Tagger">
                <tagToGive>TrainedAnimalBehavior</tagToGive>
                <subNodes>
                  <li Class="Dryad.JobGiver_Sow">
                    <maxDistance>70</maxDistance>
                  </li>
                </subNodes>
              </li>
            </subNodes>
          </li>
          <li Class="ThinkNode_Tagger"> 
            <tagToGive>TrainedAnimalBehavior</tagToGive>
            <subNodes>
              <li Class="Dryad.JobGiver_Sow"> <!--This is a more reliable short-ranged version.-->
                <maxDistance>14</maxDistance>
              </li>
            </subNodes>
          </li>
        </subNodes>
      </li>
    </value>
  </Operation>  

  <Operation Class="PatchOperationAdd">
    <xpath>Defs/ThingDef[@Name="DryadBase"]/statBases</xpath>
    <value>
      <RestRateMultiplier>2</RestRateMultiplier>
      <PlantWorkSpeed>0.25</PlantWorkSpeed>
    </value>
  </Operation>

  <Operation Class="PatchOperationAdd">
    <xpath>Defs/ThingDef[defName="Dryad_Woodmaker"]/statBases</xpath>
    <value>
      <RestRateMultiplier>1</RestRateMultiplier>
      <PlantWorkSpeed>0.4</PlantWorkSpeed>
    </value>
  </Operation>

  <!-- <Operation Class="PatchOperationAdd">
    <xpath>Defs/ThingDef[defName="Dryad_Medicinemaker"]/statBases</xpath>
    <value>
      <PlantWorkSpeed>0.3</PlantWorkSpeed>
    </value>
  </Operation> -->

  <Operation Class="PatchOperationAdd">
    <xpath>Defs/ThingDef[defName="Dryad_Woodmaker"]/race</xpath>
    <value>
      <trainability>Advanced</trainability>
      <trainableTags>
        <li>Basic</li>
        <li>Combat</li>
        <li>Work</li>
      </trainableTags>
      <untrainableTags>
        <li>Help</li>
      </untrainableTags>
    </value>
  </Operation>

  <Operation Class="PatchOperationAdd">
    <xpath>Defs/ThingDef[defName="Dryad_Medicinemaker"]/race</xpath>
    <value>
      <trainability>Advanced</trainability>
      <trainableTags>
        <li>Help</li>
      </trainableTags>
      <untrainableTags>
        <li>Work</li>
        <li>Basic</li>
        <li>Combat</li>
      </untrainableTags>
    </value>
  </Operation>

  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="Dryad_Carrier"]/race/trainableTags</xpath>
    <value>
      <trainableTags>
        <li>Help</li>
        <li>Work</li>
      </trainableTags>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="Dryad_Carrier"]/race/untrainableTags</xpath>
    <value>
      <untrainableTags>
        <li>Combat</li>
        <li>Basic</li>
      </untrainableTags>
    </value>
  </Operation>

  <Operation Class="PatchOperationAdd">
    <xpath>Defs/StatDef[defName="PlantWorkSpeed"]/showOnPawnKind</xpath>
    <value>
      <li>Dryad_Berrymaker</li>
      <li>Dryad_Woodmaker</li>
      <li>Dryad_Medicinemaker</li>
    </value>
  </Operation>

</Patch>